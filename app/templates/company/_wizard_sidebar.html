<nav class="hierarchical-nav">
    <ul>
        {% for parent in navigation_state %}
            <li class="nav-parent {{ 'is-active' if parent.is_active else '' }}">
                <span class="parent-name">{{ parent.name }}</span>
                
                {% if parent.is_active and parent.children %}
                    <ul class="nav-children">
                        {% for child in parent.children %}
                            {% set status = '' %}
                            {% if parent.type == 'wizard' %}
                                {# プロセス型の場合のステータス #}
                                {% set status = 'is-current' if child.is_active else 'is-completed' if child.is_completed else 'is-pending' %}
                            {% elif parent.type == 'menu' %}
                                {# ハブ型の場合のステータス #}
                                {% set status = 'is-menu-active' if child.is_active else 'is-menu-default' %}
                            {% endif %}
                            <li class="progress-step {{ status }}">
                                <a href="{{ child.url }}">
                                    <span class="progress-marker"></span>
                                    <span class="progress-label">{{ child.name }}</span>
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
</nav>