{% extends "base.html" %}

{% block title %}勘定科目マッピングの管理 - {{ super() }}{% endblock %}

{% block sidebar %}
    {% include 'company/_wizard_sidebar.html' %}
{% endblock %}

{% block content %}
<h1 class="content-title">勘定科目マッピングの管理</h1>
<p class="content-subtitle">
    これまでに登録した勘定科目のマッピング情報の一覧です。<br>
    不要になったマッピングを個別に削除できます。
</p>

<div class="card">
    {% if mappings %}
    <table class="table">
        <thead>
            <tr>
                <th>会計ソフト</th>
                <th>あなたのファイルの勘定科目</th>
                <th>アプリの勘定科目</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for mapping in mappings %}
            <tr>
                <td>{{ mapping.software_name }}</td>
                <td>{{ mapping.original_account_name }}</td>
                <td>
                    {{ mapping.master_account.name }}
                    <span class="text-light">
                        {% if mapping.master_account.minor_category %} ＜ {{ mapping.master_account.minor_category }}{% endif %}
                        {% if mapping.master_account.middle_category %} ＜ {{ mapping.master_account.middle_category }}{% endif %}
                    </span>
                </td>
                <td>
                    <form method="POST" action="{{ url_for('company.delete_mapping', mapping_id=mapping.id) }}" onsubmit="return confirm('このマッピングを削除しますか？');" style="display: inline;">
                        <button type="submit" class="action-icon" title="削除">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="3 6 5 6 21 6"></polyline>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                <line x1="14" y1="11" x2="14" y2="17"></line>
                            </svg>
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state-compact">
        <p>登録されているマッピング情報はありません。</p>
    </div>
    {% endif %}

    <div class="form-actions">
        <a href="{{ url_for('company.select_software') }}" class="button-secondary">戻る</a>
    </div>
</div>
{% endblock %}
