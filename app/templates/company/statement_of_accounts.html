{% extends "base.html" %}

{% block title %}{{ page_title }} - 勘定科目内訳書{% endblock %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pages/statement_of_accounts.css') }}">
{% endblock %}

{% block sidebar %}
    {% include 'company/_wizard_sidebar.html' %}
{% endblock %}

{% from 'company/_soa_macros.html' import header_actions, empty_state, summary_generic, summary_borrowings %}
{% from '_components/_button_macros.html' import render_pdf_button_if_available %}
{% from 'company/_layout_helpers.html' import render_difference %}
{% block content %}
<div class="content-header">
    <div class="header-main">
        <h1 class="content-title">{{ page_title }}の内訳</h1>
        <p class="content-subtitle">登録された{{ page_title }}の情報を確認・編集します。</p>
    </div>
    <div class="header-actions">
        {{ header_actions(page, (generic_summary.difference if generic_summary else 0), soa_next_url) }}
        {% if page == 'notes_receivable' %}
          {{ render_pdf_button_if_available(page, pdf_year) }}
        {% endif %}
        {% if page == 'temporary_payments' %}
          {{ render_pdf_button_if_available(page, pdf_year) }}
        {% endif %}
    </div>
</div>

{# Soft-commonized post-create panel: appears once after successful creation. No layout changes elsewhere. #}
{% if post_create %}
  {% include '_components/success_panel.html' %}
{% endif %}

{% if page == 'deposits' %}
  {{ summary_generic('B/S上の預金残高', deposit_summary.bs_total, deposit_summary.breakdown_total, deposit_summary.difference) }}
{% endif %}

{% if page == 'notes_receivable' %}
  {{ summary_generic('B/S上の受取手形残高', notes_receivable_summary.bs_total, notes_receivable_summary.breakdown_total, notes_receivable_summary.difference) }}
{% endif %}

{% if page == 'accounts_receivable' %}
  {{ summary_generic('B/S上の売掛金（未収入金）残高', accounts_receivable_summary.bs_total, accounts_receivable_summary.breakdown_total, accounts_receivable_summary.difference) }}
{% endif %}

{% if page in ['temporary_payments','loans_receivable','inventories','securities','fixed_assets','notes_payable','accounts_payable','temporary_receipts','executive_compensations','land_rents','miscellaneous','misc_income','misc_losses'] %}
  {{ summary_generic(generic_summary_label, generic_summary.bs_total, generic_summary.breakdown_total, generic_summary.difference) }}
{% endif %}

{% if page == 'borrowings' %}
  {{ summary_borrowings(borrowings_summary.bs_total, borrowings_summary.pl_interest_total, borrowings_summary.breakdown_total, borrowings_summary.difference) }}
{% endif %}

<div class="card-grid">
    {% if items %}        {% include 'company/_cards/' + page + '_card.html' %}
    {% else %}
        {{ empty_state(page_title, page) }}
    {% endif %}
</div>
{% endblock %}
