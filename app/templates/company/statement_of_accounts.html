{% extends "base.html" %}

{% block title %}{{ page_title }} - 勘定科目内訳書{% endblock %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pages/statement_of_accounts.css') }}">
{% endblock %}

{% block sidebar %}
    {% include 'company/_wizard_sidebar.html' %}
{% endblock %}

{% block content %}
<div class="content-header">
    <div class="header-main">
        <h1 class="content-title">{{ page_title }}の内訳</h1>
        <p class="content-subtitle">登録された{{ page_title }}の情報を確認・編集します。</p>
    </div>
    <div class="header-actions">
        <a href="{{ url_for('company.add_item', page_key=page) }}" class="button-primary">＋ 新規登録</a>
    </div>
</div>

{% if page == 'deposits' %}
<div class="card summary-card">
    <div class="summary-item">
        <span class="summary-label">B/S上の預金残高</span>
        <span class="summary-value">{{ (deposit_summary.bs_total | default(0)) | format_currency }}</span>
    </div>
    <div class="summary-item">
        <span class="summary-label">内訳明細の合計額</span>
        <span class="summary-value">{{ (deposit_summary.breakdown_total | default(0)) | format_currency }}</span>
    </div>
    <div class="summary-item result {% if deposit_summary.difference == 0 %}zero{% else %}non-zero{% endif %}">
        <span class="summary-label">差額</span>
        <span class="summary-value">{{ (deposit_summary.difference | default(0)) | format_currency }}</span>
    </div>
</div>
{% endif %}

{% if page == 'notes_receivable' %}
<div class="card summary-card">
    <div class="summary-item">
        <span class="summary-label">B/S上の受取手形残高</span>
        <span class="summary-value">{{ (notes_receivable_summary.bs_total | default(0)) | format_currency }}</span>
    </div>
    <div class="summary-item">
        <span class="summary-label">内訳明細の合計額</span>
        <span class="summary-value">{{ (notes_receivable_summary.breakdown_total | default(0)) | format_currency }}</span>
    </div>
    <div class="summary-item result {% if notes_receivable_summary.difference == 0 %}zero{% else %}non-zero{% endif %}">
        <span class="summary-label">差額</span>
        <span class="summary-value">{{ (notes_receivable_summary.difference | default(0)) | format_currency }}</span>
    </div>
</div>
{% endif %}

{% if page == 'accounts_receivable' %}
<div class="card summary-card">
    <div class="summary-item">
        <span class="summary-label">B/S上の売掛金（未収入金）残高</span>
        <span class="summary-value">{{ (accounts_receivable_summary.bs_total | default(0)) | format_currency }}</span>
    </div>
    <div class="summary-item">
        <span class="summary-label">内訳明細の合計額</span>
        <span class="summary-value">{{ (accounts_receivable_summary.breakdown_total | default(0)) | format_currency }}</span>
    </div>
    <div class="summary-item result {% if (accounts_receivable_summary.difference | default(0)) == 0 %}zero{% else %}non-zero{% endif %}">
        <span class="summary-label">差額</span>
        <span class="summary-value">{{ (accounts_receivable_summary.difference | default(0)) | format_currency }}</span>
    </div>
</div>
{% endif %}

{% if page in ['temporary_payments','loans_receivable','inventories','securities','fixed_assets','notes_payable','accounts_payable','temporary_receipts','borrowings','executive_compensations','land_rents','miscellaneous'] %}
<div class="card summary-card">
    <div class="summary-item">
        <span class="summary-label">{{ generic_summary_label }}</span>
        <span class="summary-value">{{ (generic_summary.bs_total | default(0)) | format_currency }}</span>
    </div>
    <div class="summary-item">
        <span class="summary-label">内訳明細の合計額</span>
        <span class="summary-value">{{ (generic_summary.breakdown_total | default(0)) | format_currency }}</span>
    </div>
    <div class="summary-item result {% if (generic_summary.difference | default(0)) == 0 %}zero{% else %}non-zero{% endif %}">
        <span class="summary-label">差額</span>
        <span class="summary-value">{{ (generic_summary.difference | default(0)) | format_currency }}</span>
    </div>
</div>
{% endif %}

<div class="card-grid">
    {% if items %}        {% include 'company/_cards/' + page + '_card.html' %}
    {% else %}
        <div class="empty-state-card">
            <h2>まだ{{ page_title }}が登録されていません</h2>
            <p>右上の「＋ 新規登録」ボタンから最初の情報を登録してください。</p>
            <a href="{{ url_for('company.add_item', page_key=page) }}" class="button-primary">最初の{{ page_title }}を登録する</a>
        </div>
    {% endif %}
</div>
{% endblock %}
