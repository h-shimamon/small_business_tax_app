# フェーズB適用前チェックリスト（受取手形 Date 統一）

## 1. 事前タスク
- [ ] 本番 DB フルバックアップ取得（ダンプファイル保管）。
- [ ] ステージングで最新リリースブランチ＋フェーズBマイグレーションを適用済み。
- [ ] `flask report-date-health --format json` をステージングで実行し、`str_only`/`mismatch` が 0 を確認。
- [ ] テストスイート実行（`pytest`）。
- [ ] 受取手形 PDF をステージングで印刷確認。

## 2. 本番適用フロー
1. `flask db upgrade`（フェーズBリビジョン）実行。
2. `flask report-date-health --format json` を本番で実行し、レポートを保存。
3. アプリの受取手形一覧と入力フォームが正常に動作することを確認。

## 3. ロールバック手順
- マイグレーション適用前に取得したバックアップから対象テーブルをリストア。
- Alembic で `flask db downgrade <previous_revision>` を実行。
- 影響範囲の再テスト後、原因調査。

## 4. モニタリング
- 適用後1〜2週間、受取手形登録関連のサポート問合せを監視。
- 異常があればバックアップからの復旧 or データ補正を検討。
